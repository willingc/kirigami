{"post_stream":{"posts":[{"id":147940,"name":"Brett Cannon","username":"brettcannon","avatar_template":"/user_avatar/discuss.python.org/brettcannon/{size}/36_2.png","created_at":"2024-02-22T02:04:37.147Z","cooked":"\u003cp\u003eTwo years since \u003ca href=\"https://peps.python.org/pep-0665/\"\u003ePEP 665\u003c/a\u003e was \u003ca href=\"https://discuss.python.org/t/pep-665-take-2-a-file-format-to-list-python-dependencies-for-reproducibility-of-an-application/11736/140\"\u003erejected\u003c/a\u003e and three years since I started working towards some lock file solution, I present my next (and last regardless of outcome) attempt at coming up with a lock file standard.\u003c/p\u003e\n\u003ch1\u003e\u003ca name=\"terms-1\" class=\"anchor\" href=\"#terms-1\"\u003e\u003c/a\u003eTerms\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e“platform”: OS plus CPU\u003c/li\u003e\n\u003cli\u003e“environment”: interpreter plus platform\u003c/li\u003e\n\u003cli\u003e“distribution”: in the PyPA spec sense, i.e. a project\u003c/li\u003e\n\u003cli\u003e“lock entry”: a set of distribution files locked for a specific environment\u003c/li\u003e\n\u003cli\u003e“lock file”: a set of lock entries for a specific set of \u003ca href=\"https://packaging.python.org/en/latest/specifications/dependency-specifiers/\"\u003edependency specifiers\u003c/a\u003e from a specific set of indexes\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003e\u003ca name=\"goals-2\" class=\"anchor\" href=\"#goals-2\"\u003e\u003c/a\u003eGoals\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eAn environment lock file standard for \u003ca href=\"https://packaging.python.org/en/latest/specifications/\" class=\"inline-onebox\"\u003ePyPA specifications - Python Packaging User Guide\u003c/a\u003e (i.e. I’m not trying to accommodate conda and this is not what \u003ccode\u003ePoetry.lock\u003c/code\u003e provides which you could consider a boundary/constraint file)\u003c/li\u003e\n\u003cli\u003eThe ability to lock for multiple environments simultaneously for the same set of dependency specifiers\u003c/li\u003e\n\u003cli\u003eYou can update all entries in a lock file regardless of the platform you are running on (i.e. all inputs into the resolver are recorded in the lock file)\u003c/li\u003e\n\u003cli\u003eYou can have different lock files for different reasons\u003c/li\u003e\n\u003cli\u003eInstallation involves determining which lock entry best applies to an environment, then its a linear install of all distribution files in the lock entry, i.e. no evaluation as to whether an individual distribution file should be installed once a lock entry is chosen, so no SAT solver is necessary\u003c/li\u003e\n\u003cli\u003eThe file format is human-readable for ease of e.g. auditing diffs, but is machine-writable (i.e. not meant to be written by hand)\u003c/li\u003e\n\u003cli\u003eNot meant to introduce new packaging concepts outside of lock files themselves\u003c/li\u003e\n\u003cli\u003eMake the sdist people happy so this gets accepted \u003cimg src=\"https://emoji.discourse-cdn.com/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003e\u003ca name=\"spec-3\" class=\"anchor\" href=\"#spec-3\"\u003e\u003c/a\u003eSpec\u003c/h1\u003e\n\u003cp\u003eLock files should be written out to a \u003ccode\u003epylock.*.toml\u003c/code\u003e file w/ a label to help identify the lock file’s purpose. The file format is TOML.\u003c/p\u003e\n\u003cp\u003eThe allowed keys in the file are listed below (all keys are required unless specified as optional). A TOML file with this also written out can be found at \u003ca href=\"https://github.com/brettcannon/mousebender/blob/resolve/pylock.spec.toml\" class=\"inline-onebox\"\u003emousebender/pylock.spec.toml at resolve · brettcannon/mousebender · GitHub\u003c/a\u003e . Examples of lock files are listed later on.\u003c/p\u003e\n\u003cp\u003eAnything w/ a \u003cimg src=\"https://emoji.discourse-cdn.com/apple/fire.png?v=12\" title=\":fire:\" class=\"emoji\" alt=\":fire:\" loading=\"lazy\" width=\"20\" height=\"20\"\u003e means it’s a contentious key.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"meta-4\" class=\"anchor\" href=\"#meta-4\"\u003e\u003c/a\u003e\u003ccode\u003emeta\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eMetadata version of the file; initially “1.0”. Since this file is designed to be human-readable but machine-writable, versioning the metadata makes sense as we don’t need to keep a backwards-compatible format for humans to directly work with and instead need a way to help tools migrate to newer metadata versions.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"indexes-5\" class=\"anchor\" href=\"#indexes-5\"\u003e\u003c/a\u003e\u003ccode\u003eindexes\u003c/code\u003e \u003cimg src=\"https://emoji.discourse-cdn.com/apple/fire.png?v=12\" title=\":fire:\" class=\"emoji\" alt=\":fire:\" loading=\"lazy\" width=\"20\" height=\"20\"\u003e\u003c/h2\u003e\n\u003cp\u003eAn array of URLs to package indexes to use to find distributions. Recorded in most- to least-preferred order. Recording the indexes used helps when adding new lock entries by making the potential distributions consistent.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"dependencies-6\" class=\"anchor\" href=\"#dependencies-6\"\u003e\u003c/a\u003e\u003ccode\u003edependencies\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eArray of top-level dependency specifiers. This acts as the input of what to resolve for, so all details are to be included (e.g. extras, markers, etc.).\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lock-7\" class=\"anchor\" href=\"#lock-7\"\u003e\u003c/a\u003e\u003ccode\u003e[[lock]]\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eA lock entry for an environment.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockmarkers-8\" class=\"anchor\" href=\"#lockmarkers-8\"\u003e\u003c/a\u003e\u003ccode\u003elock.markers\u003c/code\u003e \u003cimg src=\"https://emoji.discourse-cdn.com/apple/fire.png?v=12\" title=\":fire:\" class=\"emoji\" alt=\":fire:\" loading=\"lazy\" width=\"20\" height=\"20\"\u003e\u003c/h2\u003e\n\u003cp\u003eA table of environment markers used to produce the lock entry.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/brettcannon/mousebender/tree/resolve-markers-tags-requirements\" class=\"inline-onebox\"\u003eGitHub - brettcannon/mousebender at resolve-markers-tags-requirements\u003c/a\u003e is an alternative that uses a list of relevant markers.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"locktags-9\" class=\"anchor\" href=\"#locktags-9\"\u003e\u003c/a\u003e\u003ccode\u003elock.tags\u003c/code\u003e \u003cimg src=\"https://emoji.discourse-cdn.com/apple/fire.png?v=12\" title=\":fire:\" class=\"emoji\" alt=\":fire:\" loading=\"lazy\" width=\"20\" height=\"20\"\u003e\u003c/h2\u003e\n\u003cp\u003eAn array of wheel tags supported by the environment as used to produce the lock entry. The tags are sorted from most- to least-preferred.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/brettcannon/mousebender/tree/resolve-markers-tags-requirements\" class=\"inline-onebox\"\u003eGitHub - brettcannon/mousebender at resolve-markers-tags-requirements\u003c/a\u003e is an alternative that only lists the required wheel tag sets.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockwheel-10\" class=\"anchor\" href=\"#lockwheel-10\"\u003e\u003c/a\u003e\u003ccode\u003e[[lock.wheel]]\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eA wheel file for the lock entry (optional).\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockwheelname-11\" class=\"anchor\" href=\"#lockwheelname-11\"\u003e\u003c/a\u003e\u003ccode\u003elock.wheel.name\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eThe distribution’s normalized name. You cannot solely rely on the wheel filename to calculate this as the file name may not be a valid \u003ccode\u003e.whl\u003c/code\u003e file name due to \u003ca href=\"https://packaging.python.org/en/latest/specifications/version-specifiers/#direct-references\"\u003edirect references\u003c/a\u003e (technically a tool could download the arbitrary URL and inspect it to determine the wheel file details if one so desired). Having the name as a distinct key also has the benefit that its easier to read than from a wheel file name.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockwheelfilename-12\" class=\"anchor\" href=\"#lockwheelfilename-12\"\u003e\u003c/a\u003e\u003ccode\u003elock.wheel.filename\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eThe file’s name.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockwheelorigin-13\" class=\"anchor\" href=\"#lockwheelorigin-13\"\u003e\u003c/a\u003e\u003ccode\u003elock.wheel.origin\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eA URL or file path (via \u003ccode\u003efile://\u003c/code\u003e) where the wheel that was locked against was found. The location does not need to exist in the future, so this should be treated as only a hint to where to look and/or recording where the wheel file originally came from.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockwheelhashes-14\" class=\"anchor\" href=\"#lockwheelhashes-14\"\u003e\u003c/a\u003e\u003ccode\u003elock.wheel.hashes\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eA table of file hashes; algorithm:value pairs. This makes sure that one is getting the wheel file that was locked against for reproducibility and security purposes.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockwheeldirect-15\" class=\"anchor\" href=\"#lockwheeldirect-15\"\u003e\u003c/a\u003e\u003ccode\u003elock.wheel.direct\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eWhether \u003ccode\u003eorigin\u003c/code\u003e is the direct URL in terms of \u003ca href=\"https://packaging.python.org/en/latest/specifications/direct-url/\"\u003e\u003ccode\u003edirect_url.json\u003c/code\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockwheelrequires-python-16\" class=\"anchor\" href=\"#lockwheelrequires-python-16\"\u003e\u003c/a\u003e\u003ccode\u003elock.wheel.requires-python\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003ePython version requirement (optional). If an installer chooses to determine environment compatibility that is not as strict as an exact match of \u003ccode\u003elock.markers\u003c/code\u003e and \u003ccode\u003elock.tags\u003c/code\u003e, knowing the supporting Python versions is important to determine if this wheel file is compatible as this is not necessarily communicated via the wheel file name itself.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockwheeldependencies-17\" class=\"anchor\" href=\"#lockwheeldependencies-17\"\u003e\u003c/a\u003e\u003ccode\u003elock.wheel.dependencies\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eA list of normalized distribution names which this distribution depends on (optional). Viewing the overall lock entry as the entire worldview of distributions available, each entry can be just the distribution name (a perk of Python not allowing multiple distribution versions simultaneously). This allows for introspection as to why a distribution is included in the lock entry (i.e. calculate the dependency graph between distributions). Details like extras and markers are not necessary as the resolver has already handled them.\u003c/p\u003e\n\u003cp\u003eBecause this is not required to have a successful install, it is considered optional.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"locksdist-18\" class=\"anchor\" href=\"#locksdist-18\"\u003e\u003c/a\u003e\u003ccode\u003e[[lock.sdist]]\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eA source distribution file for the lock entry (optional).\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"locksdistname-19\" class=\"anchor\" href=\"#locksdistname-19\"\u003e\u003c/a\u003e\u003ccode\u003elock.sdist.name\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.name\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"locksdistfilename-20\" class=\"anchor\" href=\"#locksdistfilename-20\"\u003e\u003c/a\u003e\u003ccode\u003elock.sdist.filename\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.filename\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"locksdistorigin-21\" class=\"anchor\" href=\"#locksdistorigin-21\"\u003e\u003c/a\u003e\u003ccode\u003elock.sdist.origin\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.origin\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"locksdisthashes-22\" class=\"anchor\" href=\"#locksdisthashes-22\"\u003e\u003c/a\u003e\u003ccode\u003elock.sdist.hashes\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.hashes\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"locksdistdirect-23\" class=\"anchor\" href=\"#locksdistdirect-23\"\u003e\u003c/a\u003e\u003ccode\u003elock.sdist.direct\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.direct\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"locksdistrequires-python-24\" class=\"anchor\" href=\"#locksdistrequires-python-24\"\u003e\u003c/a\u003e\u003ccode\u003elock.sdist.requires-python\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.requires-python\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"locksdistdependencies-25\" class=\"anchor\" href=\"#locksdistdependencies-25\"\u003e\u003c/a\u003e\u003ccode\u003elock.sdist.dependencies\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.dependencies\u003c/code\u003e for what is recorded in this array (optional). The contents may come from either:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ePKG-INFO\u003c/code\u003e if \u003ccode\u003eMetadata-Version\u003c/code\u003e is 2.2 or higher and the appropriate fields are not \u003ccode\u003eDynamic\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eFrom building the sdist.\u003c/li\u003e\n\u003cli\u003eEtc.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e\u003ca name=\"locksdistbuild-requires-26\" class=\"anchor\" href=\"#locksdistbuild-requires-26\"\u003e\u003c/a\u003e\u003ccode\u003e[[lock.sdist.build-requires]]\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eAn array of files that \u003cem\u003ecan\u003c/em\u003e be used or \u003cem\u003ewere\u003c/em\u003e used to build the sdist based on \u003ca href=\"https://packaging.python.org/en/latest/specifications/pyproject-toml/#declaring-build-system-dependencies-the-build-system-table\"\u003e\u003ccode\u003ebuild-system.requires\u003c/code\u003e from \u003ccode\u003epyproject.toml\u003c/code\u003e\u003c/a\u003e (optional). The acceptable keys are \u003ccode\u003ewheel\u003c/code\u003e and \u003ccode\u003esdist\u003c/code\u003e and their values match what is acceptable under the same name directly under \u003ccode\u003e[[lock]]\u003c/code\u003e. Any future expansion of acceptable distribution types under \u003ccode\u003e[[lock]]\u003c/code\u003e will also be supported here.\u003c/p\u003e\n\u003cp\u003eThis effectively makes the table a self-contained lock entry just for this sdist with \u003ccode\u003ebuild-system.requires\u003c/code\u003e providing the value for \u003ccode\u003edependencies\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eIt absent, it is at the installer’s discretion how to go about building the sdist (including refusing to).\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockgit-27\" class=\"anchor\" href=\"#lockgit-27\"\u003e\u003c/a\u003e\u003ccode\u003e[[lock.git]]\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eA Git repository of source code for the lock entry (optional).\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockgitname-28\" class=\"anchor\" href=\"#lockgitname-28\"\u003e\u003c/a\u003e\u003ccode\u003elock.git.name\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.name\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockgitrepo-29\" class=\"anchor\" href=\"#lockgitrepo-29\"\u003e\u003c/a\u003e\u003ccode\u003elock.git.repo\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eA URL to the Git repository; it may be a \u003ccode\u003efile://\u003c/code\u003e path.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockgitcommit-30\" class=\"anchor\" href=\"#lockgitcommit-30\"\u003e\u003c/a\u003e\u003ccode\u003elock.git.commit\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eThe commit of the repository to use. It should be a specific commit and not a tag or branch as those can change.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockgitdirect-31\" class=\"anchor\" href=\"#lockgitdirect-31\"\u003e\u003c/a\u003e\u003ccode\u003elock.git.direct\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.direct\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockgitrequires-python-32\" class=\"anchor\" href=\"#lockgitrequires-python-32\"\u003e\u003c/a\u003e\u003ccode\u003elock.git.requires-python\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.requires-python\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"lockgitdependencies-33\" class=\"anchor\" href=\"#lockgitdependencies-33\"\u003e\u003c/a\u003e\u003ccode\u003elock.git.dependencies\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.wheel.dependencies\u003c/code\u003e for what is recorded in this array (optional). The contents may come from:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003epyproject.toml\u003c/code\u003e if \u003ccode\u003eproject.dependencies\u003c/code\u003e (and \u003ccode\u003eproject.optional-dependencies\u003c/code\u003e as appropriate) exists and is not \u003ccode\u003edynamic\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eFrom building the repository based on its \u003ccode\u003epyproject.toml\u003c/code\u003e file.\u003c/li\u003e\n\u003cli\u003eEtc.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e\u003ca name=\"lockgitbuild-requires-34\" class=\"anchor\" href=\"#lockgitbuild-requires-34\"\u003e\u003c/a\u003e\u003ccode\u003e[[lock.git.build-requires]]\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSee \u003ccode\u003elock.sdist.build-requires\u003c/code\u003e (optional).\u003c/p\u003e\n\u003ch2\u003e\u003ca name=\"tool-35\" class=\"anchor\" href=\"#tool-35\"\u003e\u003c/a\u003e\u003ccode\u003e[tool]\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSame as \u003ccode\u003epyproject.toml\u003c/code\u003e (optional).\u003c/p\u003e\n\u003ch1\u003e\u003ca name=\"examples-36\" class=\"anchor\" href=\"#examples-36\"\u003e\u003c/a\u003eExamples\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/brettcannon/mousebender/blob/resolve/pylock.compatibility-example.toml\"\u003eA lock file with entries for multiple environments\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/brettcannon/mousebender/blob/resolve/pylock.graph-example.toml\"\u003eA larger lock file\u003c/a\u003e w/ accompanying \u003ca href=\"https://github.com/brettcannon/mousebender/blob/resolve/pylock.graph-example.md\"\u003edependency graph of the lock file\u003c/a\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1\u003e\u003ca name=\"proof-of-concept-37\" class=\"anchor\" href=\"#proof-of-concept-37\"\u003e\u003c/a\u003eProof of Concept\u003c/h1\u003e\n\u003cp\u003eThe \u003ca href=\"https://github.com/brettcannon/mousebender/tree/resolve\"\u003e\u003ccode\u003eresolve\u003c/code\u003e branch of my mousebender project\u003c/a\u003e has a wheels-only, requires-PyPI-\u003ca href=\"https://peps.python.org/pep-0714/\"\u003ePEP-714\u003c/a\u003e-metadata lock generation tool (the restrictions are because I only have so much time and we now have alternative installers showing up, so I don’t need to aim for completeness). You can look at the \u003ca href=\"https://github.com/brettcannon/mousebender/blob/resolve/update-examples.sh\"\u003eshell script that I use to generate the examples\u003c/a\u003e listed above to see how to play with it. The \u003ccode\u003einstall\u003c/code\u003e subcommand doesn’t do anything but list out the wheel filenames that would be installed since installation isn’t interesting thanks to the 'installer` project and the only decision at install time is which lock entry to use.\u003c/p\u003e\n\u003cp\u003eThe key point, though, is I was able to write a proof-of-concept that produces and consumes lock files based on this spec.\u003c/p\u003e\n\u003ch1\u003e\u003ca name=\"pep-665-comparison-38\" class=\"anchor\" href=\"#pep-665-comparison-38\"\u003e\u003c/a\u003ePEP 665 Comparison\u003c/h1\u003e\n\u003cp\u003eThe most obvious difference is the inclusion of sdists from the start. \u003cimg src=\"https://emoji.discourse-cdn.com/apple/grin.png?v=12\" title=\":grin:\" class=\"emoji\" alt=\":grin:\" loading=\"lazy\" width=\"20\" height=\"20\"\u003e But that was facilitated by making each distribution file type their own concept which is also different. The concept of lock entries is also different.\u003c/p\u003e","post_number":1,"post_type":1,"updated_at":"2024-02-26T20:25:08.497Z","reply_count":10,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1744,"reads":305,"readers_count":304,"score":9581.0,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Brett Cannon","primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_bg_color":"006b94","flair_color":"fac731","flair_group_id":41,"version":5,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"link_counts":[{"url":"https://github.com/brettcannon/mousebender/blob/resolve/pylock.compatibility-example.toml","internal":false,"reflection":false,"title":"mousebender/pylock.compatibility-example.toml at resolve · brettcannon/mousebender · GitHub","clicks":74},{"url":"https://peps.python.org/pep-0665/","internal":false,"reflection":false,"title":"PEP 665 – A file format to list Python dependencies for reproducibility of an application | peps.python.org","clicks":70},{"url":"https://github.com/brettcannon/mousebender/blob/resolve/pylock.spec.toml","internal":false,"reflection":false,"title":"mousebender/pylock.spec.toml at resolve · brettcannon/mousebender · GitHub","clicks":54},{"url":"https://discuss.python.org/t/pep-665-take-2-a-file-format-to-list-python-dependencies-for-reproducibility-of-an-application/11736/140","internal":true,"reflection":false,"title":"PEP 665, take 2 -- A file format to list Python dependencies for reproducibility of an application","clicks":29},{"url":"https://github.com/brettcannon/mousebender/blob/resolve/pylock.graph-example.toml","internal":false,"reflection":false,"title":"mousebender/pylock.graph-example.toml at resolve · brettcannon/mousebender · GitHub","clicks":26},{"url":"https://github.com/brettcannon/mousebender/blob/resolve/pylock.graph-example.md","internal":false,"reflection":false,"title":"mousebender/pylock.graph-example.md at resolve · brettcannon/mousebender · GitHub","clicks":23},{"url":"https://peps.python.org/pep-0714/","internal":false,"reflection":false,"title":"PEP 714 – Rename dist-info-metadata in the Simple API | peps.python.org","clicks":14},{"url":"https://github.com/brettcannon/mousebender/tree/resolve","internal":false,"reflection":false,"title":"GitHub - brettcannon/mousebender at resolve","clicks":13},{"url":"https://packaging.python.org/en/latest/specifications/dependency-specifiers/","internal":false,"reflection":false,"title":"Dependency specifiers - Python Packaging User Guide","clicks":9},{"url":"https://github.com/brettcannon/mousebender/tree/resolve-markers-tags-requirements","internal":false,"reflection":false,"title":"GitHub - brettcannon/mousebender at resolve-markers-tags-requirements","clicks":8},{"url":"https://packaging.python.org/en/latest/specifications/","internal":false,"reflection":false,"title":"PyPA specifications - Python Packaging User Guide","clicks":6},{"url":"https://github.com/brettcannon/mousebender/blob/resolve/update-examples.sh","internal":false,"reflection":false,"title":"mousebender/update-examples.sh at resolve · brettcannon/mousebender · GitHub","clicks":4},{"url":"https://packaging.python.org/en/latest/specifications/direct-url/","internal":false,"reflection":false,"title":"Recording the Direct URL Origin of installed distributions - Python Packaging User Guide","clicks":2},{"url":"https://packaging.python.org/en/latest/specifications/pyproject-toml/#declaring-build-system-dependencies-the-build-system-table","internal":false,"reflection":false,"title":"pyproject.toml specification - Python Packaging User Guide","clicks":1},{"url":"https://packaging.python.org/en/latest/specifications/version-specifiers/#direct-references","internal":false,"reflection":false,"title":"Version specifiers - Python Packaging User Guide","clicks":0}],"read":true,"user_title":"CPython core developer","title_is_group":true,"bookmarked":false,"actions_summary":[{"id":2,"count":48,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":true,"admin":true,"staff":true,"user_id":36,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2018-09-28","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false,"can_vote":false},{"id":147941,"name":"Brett Cannon","username":"brettcannon","avatar_template":"/user_avatar/discuss.python.org/brettcannon/{size}/36_2.png","created_at":"2024-02-22T02:07:51.130Z","cooked":"\u003cp\u003ecc’ing folks for various tools:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca class=\"mention\" href=\"/u/ofek\"\u003e@ofek\u003c/a\u003e for Hatch\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"mention\" href=\"/u/frostming\"\u003e@frostming\u003c/a\u003e for PDM\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"mention\" href=\"/u/secrus\"\u003e@Secrus\u003c/a\u003e and \u003ca class=\"mention\" href=\"/u/radoering\"\u003e@radoering\u003c/a\u003e for Poetry\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"mention\" href=\"/u/konstin\"\u003e@konstin\u003c/a\u003e and \u003ca class=\"mention\" href=\"/u/charliermarsh\"\u003e@charliermarsh\u003c/a\u003e for uv\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"mention\" href=\"/u/pf_moore\"\u003e@pf_moore\u003c/a\u003e sort of for pip, but also since he will either have to delegate or decide on the eventual PEP\u003c/li\u003e\n\u003c/ul\u003e","post_number":2,"post_type":1,"updated_at":"2024-02-22T02:07:51.130Z","reply_count":2,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":5,"reads":250,"readers_count":249,"score":175.0,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Brett Cannon","primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_bg_color":"006b94","flair_color":"fac731","flair_group_id":41,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":"CPython core developer","title_is_group":true,"bookmarked":false,"actions_summary":[{"id":2,"count":6,"acted":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":true,"admin":true,"staff":true,"user_id":36,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2018-09-28","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":147977,"name":"Laurie O","username":"EpicWink","avatar_template":"/user_avatar/discuss.python.org/epicwink/{size}/17968_2.png","created_at":"2024-02-22T07:05:27.507Z","cooked":"\u003caside class=\"quote group-committers\" data-username=\"brettcannon\" data-post=\"1\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/brettcannon/48/36_2.png\" class=\"avatar\"\u003e Brett Cannon:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003ccode\u003epylock.*.toml\u003c/code\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eAre you wedded to having \u003ccode\u003epylock\u003c/code\u003e at the start of the filename? Having \u003ccode\u003e*.pylock.toml\u003c/code\u003e makes more sense in terms of hierarchy (more specific first), and puts the lock’s purpose at the start. I couldn’t find any discussion on the change from PEP 665 in \u003ca href=\"https://discuss.python.org/t/pep-665-take-2-a-file-format-to-list-python-dependencies-for-reproducibility-of-an-application/11736\"\u003ethe last topic\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eAlso, this change better supports an idea of a default lock-file \u003ccode\u003epylock.toml\u003c/code\u003e, where the purpose isn’t named.\u003c/p\u003e\n\u003chr\u003e\n\u003caside class=\"quote group-committers\" data-username=\"brettcannon\" data-post=\"1\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/brettcannon/48/36_2.png\" class=\"avatar\"\u003e Brett Cannon:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003ch2\u003e\u003ccode\u003eindexes\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eAn array of URLs to package indexes to use to find distributions. Recorded in most- to least-preferred order.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eAre installers free to pull from an index not specified in this list? PEP 665 seems to suggest this.\u003c/p\u003e\n\u003cp\u003eEven if the answer is no, this is still effectively impossible to enforce by installers due to proxies and routing configuration.\u003c/p\u003e\n\u003chr\u003e\n\u003caside class=\"quote group-committers quote-modified\" data-username=\"brettcannon\" data-post=\"1\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/brettcannon/48/36_2.png\" class=\"avatar\"\u003e Brett Cannon:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003ch2\u003e\u003ccode\u003elock.sdist.dependencies\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003e…\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFrom building the sdist.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eDoes that allow PEP 517 \u003ccode\u003eprepare_metadata_for_build_wheel\u003c/code\u003e?\u003c/p\u003e\n\u003chr\u003e\n\u003caside class=\"quote group-committers\" data-username=\"brettcannon\" data-post=\"1\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/brettcannon/48/36_2.png\" class=\"avatar\"\u003e Brett Cannon:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003ch2\u003e\u003ccode\u003e[[lock.sdist.build-requires]]\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eAn array of files that \u003cem\u003ecan\u003c/em\u003e be used or \u003cem\u003ewere\u003c/em\u003e used to build the sdist based on \u003ca href=\"https://packaging.python.org/en/latest/specifications/pyproject-toml/#declaring-build-system-dependencies-the-build-system-table\" rel=\"noopener nofollow ugc\"\u003e\u003ccode\u003ebuild-system.requires\u003c/code\u003e from \u003ccode\u003epyproject.toml\u003c/code\u003e.\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eThe actual build requirements would come from PEP 517 hook \u003ccode\u003eget_requires_for_build_wheel\u003c/code\u003e (backends may inject their own after reading pyproject.toml).\u003c/p\u003e\n\u003chr\u003e\n\u003caside class=\"quote group-committers\" data-username=\"brettcannon\" data-post=\"1\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/brettcannon/48/36_2.png\" class=\"avatar\"\u003e Brett Cannon:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003ch2\u003e\u003ccode\u003e[[lock.git]]\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eA Git repository\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eAny support for non-Git VCS? \u003ca href=\"https://packaging.python.org/en/latest/specifications/version-specifiers/#file-urls\" rel=\"noopener nofollow ugc\"\u003eVersion specifiers\u003c/a\u003e support arbitrary VCS.\u003c/p\u003e\n\u003chr\u003e\n\u003caside class=\"quote group-committers\" data-username=\"brettcannon\" data-post=\"1\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/brettcannon/48/36_2.png\" class=\"avatar\"\u003e Brett Cannon:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003ch2\u003e\u003ccode\u003e[[tool]]\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eSame as \u003ccode\u003epyproject.toml\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eTo be the same as pyproject.toml, this would be a table, not an array of tables:\u003c/p\u003e\n\u003cpre data-code-wrap=\"toml\"\u003e\u003ccode class=\"lang-toml\"\u003e[tool.foo]\nbar = 42\n\n[tool.spam]\neggs = \"beans\"\n\u003c/code\u003e\u003c/pre\u003e","post_number":3,"post_type":1,"updated_at":"2024-02-22T07:06:05.742Z","reply_count":2,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":10,"reads":254,"readers_count":253,"score":155.8,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Laurie O","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"flair_group_id":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"link_counts":[{"url":"https://packaging.python.org/en/latest/specifications/version-specifiers/#file-urls","internal":false,"reflection":false,"title":"Version specifiers - Python Packaging User Guide","clicks":6},{"url":"https://discuss.python.org/t/pep-665-take-2-a-file-format-to-list-python-dependencies-for-reproducibility-of-an-application/11736","internal":true,"reflection":false,"title":"PEP 665, take 2 -- A file format to list Python dependencies for reproducibility of an application","clicks":2}],"read":true,"user_title":"","bookmarked":false,"actions_summary":[{"id":2,"count":3,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":1455,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2020-01-02","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":147982,"name":"Philipp A.","username":"flying-sheep","avatar_template":"/user_avatar/discuss.python.org/flying-sheep/{size}/1254_2.png","created_at":"2024-02-22T08:02:29.829Z","cooked":"\u003caside class=\"quote no-group\" data-username=\"EpicWink\" data-post=\"3\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/epicwink/48/17968_2.png\" class=\"avatar\"\u003e Laurie O:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAny support for non-Git VCS? \u003ca href=\"https://packaging.python.org/en/latest/specifications/version-specifiers/#file-urls\" rel=\"noopener nofollow ugc\"\u003eVersion specifiers\u003c/a\u003e support arbitrary VCS.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eI think git is the only non-pypa standard that appears in a key here. (Compare \u003ccode\u003ehashes\u003c/code\u003e as opposed to a specific hash algorithm)\u003c/p\u003e","post_number":4,"post_type":1,"updated_at":"2024-02-22T08:02:29.829Z","reply_count":0,"reply_to_post_number":3,"quote_count":1,"incoming_link_count":1,"reads":235,"readers_count":234,"score":67.0,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Philipp A.","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"flair_group_id":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":1125,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2019-08-09","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148009,"name":"Paul Moore","username":"pf_moore","avatar_template":"/user_avatar/discuss.python.org/pf_moore/{size}/35_2.png","created_at":"2024-02-22T09:35:59.493Z","cooked":"\u003cp\u003eI’m happy to be PEP-delegate. I feel I owe you another go at this after PEP 665 \u003cimg src=\"https://emoji.discourse-cdn.com/apple/slightly_smiling_face.png?v=12\" title=\":slightly_smiling_face:\" class=\"emoji\" alt=\":slightly_smiling_face:\" loading=\"lazy\" width=\"20\" height=\"20\"\u003e\u003c/p\u003e\n\u003cp\u003eOverall, this looks reasonable to me - I’ll avoid bikeshedding on details, as I’m sure plenty of people will do that \u003cimg src=\"https://emoji.discourse-cdn.com/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"\u003e\u003c/p\u003e","post_number":5,"post_type":1,"updated_at":"2024-02-22T09:35:59.493Z","reply_count":1,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":9,"reads":237,"readers_count":236,"score":232.4,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Paul Moore","primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_bg_color":"006b94","flair_color":"fac731","flair_group_id":41,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":"CPython core developer","title_is_group":true,"reply_to_user":{"username":"brettcannon","name":"Brett Cannon","avatar_template":"/user_avatar/discuss.python.org/brettcannon/{size}/36_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":7,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":35,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2018-09-28","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148017,"name":"Paul Moore","username":"pf_moore","avatar_template":"/user_avatar/discuss.python.org/pf_moore/{size}/35_2.png","created_at":"2024-02-22T09:49:41.849Z","cooked":"\u003cp\u003eOne point I was unsure about was how a lockfile consumer picks which lock entry to use - specifically around the tags. Checking the mousebender implementation I see you have “strict” and “compatible” matching defined. I think that in the actual PEP, it would be useful to document those two matching modes, even if you prefer them only to be examples, and explain when you’d expect each of them to be appropriate.\u003c/p\u003e","post_number":6,"post_type":1,"updated_at":"2024-02-22T09:49:41.849Z","reply_count":1,"reply_to_post_number":5,"quote_count":0,"incoming_link_count":1,"reads":233,"readers_count":232,"score":71.6,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Paul Moore","primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_bg_color":"006b94","flair_color":"fac731","flair_group_id":41,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":"CPython core developer","title_is_group":true,"reply_to_user":{"username":"pf_moore","name":"Paul Moore","avatar_template":"/user_avatar/discuss.python.org/pf_moore/{size}/35_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":35,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2018-09-28","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148034,"name":"Paul Moore","username":"pf_moore","avatar_template":"/user_avatar/discuss.python.org/pf_moore/{size}/35_2.png","created_at":"2024-02-22T10:52:00.638Z","cooked":"\u003cp\u003eI just wrote a very rough draft of a function to take a \u003ca href=\"https://pip.pypa.io/en/stable/reference/installation-report/\"\u003epip installation report\u003c/a\u003e and convert it into a lockfile. It seems pretty straightforward, but there are a couple of places where I had some questions.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe installation report doesn’t record the wheel tags pip used, so I can’t populate the \u003ccode\u003elock.tags\u003c/code\u003e array. The spec says this is optional, so I assume this isn’t technically an issue. A missing (which I assume is the same as “empty”) tag set in the lockfile is compatible with any environment, so it’s simply up to the user not to use the lockfile in an inappropriate environment, which I think is fine.\u003c/li\u003e\n\u003cli\u003eI have to use the filename from the URL to determine if the entry file is a wheel or not. I don’t think that’s a major issue, but it does make the whole “wheel vs sdist” split feel a little artificial. The PEP should probably include a rationale for why it’s important to have separate \u003ccode\u003ewheel\u003c/code\u003e and \u003ccode\u003esdist\u003c/code\u003e tables\u003csup class=\"footnote-ref\"\u003e\u003ca href=\"#footnote-148034-1\" id=\"footnote-ref-148034-1\"\u003e[1]\u003c/a\u003e\u003c/sup\u003e.\u003c/li\u003e\n\u003cli\u003ePip doesn’t record build environment details, so I have to omit \u003ccode\u003elock.sdist.build-requires\u003c/code\u003e. I assume this would mean “installers should use their default mechanism for creating a build environment, and so can’t guarantee reproducibility”, and I think that’s fine. Is that your expectation?\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eI also note that the \u003ccode\u003elock.git\u003c/code\u003e type doesn’t include a \u003ccode\u003ebuild-requires\u003c/code\u003e section. I assume it should, as a git repository contains source.\u003c/p\u003e\n\u003cp\u003eAlso, while I see the practical reasons for having a specific “git” lock entry file type, I can see people pushing back on git getting “special treatment”. Maybe the PEP should describe this in terms of general support for VCS file types, with git being the only one defined in this iteration of the spec, but additional VCS types can be added in future spec versions as needed. That doesn’t need to be anything more than a general statement that \u003ccode\u003e[[lock.OTHER-VCS-NAME]]\u003c/code\u003e is reserved for future use, at this point.\u003c/p\u003e\n\u003chr class=\"footnotes-sep\"\u003e\n\n\u003col class=\"footnotes-list\"\u003e\n\u003cli id=\"footnote-148034-1\" class=\"footnote-item\"\u003e\u003cp\u003ebeyond \"everyone got up tight last time about sdists, so I wanted to keep them separate \u003cimg src=\"https://emoji.discourse-cdn.com/apple/slightly_smiling_face.png?v=12\" title=\":slightly_smiling_face:\" class=\"emoji\" alt=\":slightly_smiling_face:\" loading=\"lazy\" width=\"20\" height=\"20\"\u003e \u003ca href=\"#footnote-ref-148034-1\" class=\"footnote-backref\"\u003e↩︎\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e","post_number":7,"post_type":1,"updated_at":"2024-02-22T10:52:00.638Z","reply_count":2,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":236,"readers_count":235,"score":92.2,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Paul Moore","primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_bg_color":"006b94","flair_color":"fac731","flair_group_id":41,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"link_counts":[{"url":"https://pip.pypa.io/en/stable/reference/installation-report/","internal":false,"reflection":false,"title":"Installation Report - pip documentation v24.0","clicks":11}],"read":true,"user_title":"CPython core developer","title_is_group":true,"bookmarked":false,"actions_summary":[{"id":2,"count":2,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":35,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2018-09-28","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148035,"name":"Cemici","username":"cemici","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/c/91b2a8/{size}.png","created_at":"2024-02-22T10:53:58.479Z","cooked":"\u003cp\u003eDo I understand correctly that these lockfiles contain one \u003ccode\u003e[lock]\u003c/code\u003e entry for every possible (distinct) environment?\u003c/p\u003e\n\u003cp\u003eeg an entire description for “python 3.10 and x86-64”, another entire description for “python 3.9 and pypy and not extras=foo”, and so on?\u003c/p\u003e\n\u003cp\u003efor something like poetry, that would seem to require it to examine all of the markers that it encountered during locking, enumerate all of the exponentially many possible combinations, optionally merge where possible, and then write complete solutions for all of those possible combinations?\u003c/p\u003e\n\u003cp\u003eEdit: a package with n extras - even if it supported exactly one environment - would have 2**n entries?\u003c/p\u003e","post_number":8,"post_type":1,"updated_at":"2024-02-22T11:23:17.916Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":1,"reads":228,"readers_count":227,"score":70.6,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Cemici","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"flair_group_id":null,"version":2,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":1,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":21554,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2023-12-08","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148037,"name":"James Tocknell","username":"aragilar","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/c57346/{size}.png","created_at":"2024-02-22T11:02:14.962Z","cooked":"\u003cp\u003eSome additional things you may want to consider (or defer/ignore):\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eHow should \u003ccode\u003eget_requires_for_build_sdist\u003c/code\u003e and \u003ccode\u003eget_requires_for_build_wheel\u003c/code\u003e (I’m guessing they appear in \u003ccode\u003ebuild-requires\u003c/code\u003e tables, though maybe that should be called out explicitly).\u003c/li\u003e\n\u003cli\u003eWhat happens when the metadata produced during a build differs from the lock file (e.g. sdist that produces different dependencies given a different environment)?\u003c/li\u003e\n\u003c/ul\u003e","post_number":9,"post_type":1,"updated_at":"2024-02-22T11:02:14.962Z","reply_count":0,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":2,"reads":222,"readers_count":221,"score":54.4,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"James Tocknell","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"flair_group_id":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":1498,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2020-01-27","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148039,"name":"Jean Abou Samra","username":"jeanas","avatar_template":"/user_avatar/discuss.python.org/jeanas/{size}/8115_2.png","created_at":"2024-02-22T11:03:44.798Z","cooked":"\u003caside class=\"quote group-committers\" data-username=\"brettcannon\" data-post=\"1\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/brettcannon/48/36_2.png\" class=\"avatar\"\u003e Brett Cannon:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAn inline table of hashes of this file’s contents w/o the line containing the table (i.e. including the newline); algorithm:value pairs.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eWhat algorithms are allowed?\u003c/p\u003e","post_number":10,"post_type":1,"updated_at":"2024-02-22T11:03:44.798Z","reply_count":1,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":7,"reads":220,"readers_count":219,"score":84.0,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Jean Abou Samra","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"flair_group_id":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":3079,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2020-12-23","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148044,"name":"Paul Moore","username":"pf_moore","avatar_template":"/user_avatar/discuss.python.org/pf_moore/{size}/35_2.png","created_at":"2024-02-22T11:43:01.809Z","cooked":"\u003caside class=\"quote group-committers\" data-username=\"brettcannon\" data-post=\"1\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/brettcannon/48/36_2.png\" class=\"avatar\"\u003e Brett Cannon:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003ch2\u003e\u003ccode\u003elock.wheel.dependencies\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eA list of normalized distribution names which this distribution depends on. Viewing the overall lock entry as the entire worldview of distributions available, each entry can be just the distribution name (a perk of Python not allowing multiple distribution versions simultaneously). This allows for introspection as to why a distribution is included in the lock entry (i.e. calculate the dependency graph between distributions). Details like extras and markers are not necessary as the resolver has already handled them.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eI’m not sure pip can determine this accurately. We know the dependency metadata from the distribution file, and we can strip out dependencies that don’t apply in this environment, but I’m not sure we can tell what extras apply for a transitive dependency. We know the extras requested by the user for a top-level dependency, but not necessarily for transitive ones. For example, \u003ccode\u003eA\u003c/code\u003e depends on \u003ccode\u003eB[foo]\u003c/code\u003e, \u003ccode\u003eB\u003c/code\u003e depends on \u003ccode\u003eC\u003c/code\u003e, and if \u003ccode\u003efoo\u003c/code\u003e is specified, \u003ccode\u003eB\u003c/code\u003e also depends on \u003ccode\u003eD\u003c/code\u003e. If we’re asked to install \u003ccode\u003eA\u003c/code\u003e, I don’t think pip knows that \u003ccode\u003eD\u003c/code\u003e is in the final resolve because of the extra \u003ccode\u003efoo\u003c/code\u003e - clearly \u003cem\u003eresolvelib\u003c/em\u003e knows that, but I’m not sure if pip can recover that information after the resolve. I do know that the pip installation report doesn’t currently contain that data, so at the very least we’d need to modify the report output.\u003c/p\u003e\n\u003cp\u003eIf it’s not possible to calculate the dependencies accurately, what’s the best thing for lockfile producers to do? Omit the field altogether, report the minimum (in this case, \u003ccode\u003eB\u003c/code\u003e depends on \u003ccode\u003eC\u003c/code\u003e), or report the maximum (that \u003ccode\u003eB\u003c/code\u003e depends on some of \u003ccode\u003eC\u003c/code\u003e and \u003ccode\u003eD\u003c/code\u003e)\u003csup class=\"footnote-ref\"\u003e\u003ca href=\"#footnote-148044-1\" id=\"footnote-ref-148044-1\"\u003e[1]\u003c/a\u003e\u003c/sup\u003e? Basically, I don’t really know what the intended use is for this field, and therefore whether partially accurate information is better or worse than no information at all.\u003c/p\u003e\n\u003chr class=\"footnotes-sep\"\u003e\n\n\u003col class=\"footnotes-list\"\u003e\n\u003cli id=\"footnote-148044-1\" class=\"footnote-item\"\u003e\u003cp\u003eMaximum might be difficult, actually - the marker API in \u003ccode\u003epackaging\u003c/code\u003e is rather limited in that it doesn’t really allow for “evaluate, but ignoring extras”. \u003ca href=\"#footnote-ref-148044-1\" class=\"footnote-backref\"\u003e↩︎\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e","post_number":11,"post_type":1,"updated_at":"2024-02-22T11:43:50.307Z","reply_count":2,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":3,"reads":223,"readers_count":222,"score":69.6,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Paul Moore","primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_bg_color":"006b94","flair_color":"fac731","flair_group_id":41,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":"CPython core developer","title_is_group":true,"bookmarked":false,"actions_summary":[{"id":2,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":35,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2018-09-28","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148049,"name":"Carli* Freudenberg","username":"Kound","avatar_template":"/user_avatar/discuss.python.org/kound/{size}/8195_2.png","created_at":"2024-02-22T12:10:24.789Z","cooked":"\u003cp\u003eIt might be worth considering also conda as a package lock source here.\u003cbr\u003e\nThere are already several projects that try to combine \u003ccode\u003econda\u003c/code\u003e and \u003ccode\u003epip\u003c/code\u003e already, i.e.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/basnijholt/unidep\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\"\u003eGitHub - basnijholt/unidep: Single source of truth with requirements for pip and conda\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/macro128/pdm-conda\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\"\u003eGitHub - macro128/pdm-conda: A PDM plugin to install project dependencies with Conda\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/OldGrumpyViking/hatch-conda\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\"\u003eGitHub - OldGrumpyViking/hatch-conda: Hatch plugin for conda environments\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAnd I also understood that \u003ccode\u003euv\u003c/code\u003e is intended to be included within \u003ccode\u003epixi\u003c/code\u003e so that would also profit from this.\u003c/p\u003e\n\u003cp\u003eI am aware that this is a controversial topic but given the scientific community is still heavily depended on conda for their work and they need reproducible environments I think this is worth considering.\u003c/p\u003e","post_number":12,"post_type":1,"updated_at":"2024-02-22T12:10:24.789Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":3,"reads":218,"readers_count":217,"score":108.6,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Carli* Freudenberg","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"flair_group_id":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"link_counts":[{"url":"https://github.com/basnijholt/unidep","internal":false,"reflection":false,"title":"GitHub - basnijholt/unidep: Single source of truth with requirements for pip and conda","clicks":3},{"url":"https://github.com/macro128/pdm-conda","internal":false,"reflection":false,"title":"GitHub - macro128/pdm-conda: A PDM plugin to install project dependencies with Conda","clicks":2},{"url":"https://github.com/OldGrumpyViking/hatch-conda","internal":false,"reflection":false,"title":"GitHub - OldGrumpyViking/hatch-conda: Hatch plugin for conda environments","clicks":1}],"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":3,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":8010,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2022-07-22","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148052,"name":"Greg Roodt","username":"groodt","avatar_template":"/user_avatar/discuss.python.org/groodt/{size}/3248_2.png","created_at":"2024-02-22T12:31:50.365Z","cooked":"\u003cp\u003econda has been explicitly mentioned as a non-goal in the initial post.\u003cbr\u003e\n“(i.e. I’m not trying to accommodate conda)”\u003c/p\u003e\n\u003cp\u003econda already has lockfiles for environments and dependencies that users can benefit from, so I don’t think it makes sense to expand the scope of an already complex area (that has had multiple false starts and failures in its history) to accommodate a broadly isolated and not generally compatible ecosystem that doesn’t really suffer from lack of lockfiles.\u003c/p\u003e\n\u003cp\u003eSure, perhaps in future once both ecosystems have lockfiles, interoperability between ecosystems could become a noble goal. However that feels like an entirely different problem and an entirely different evolution would be required if there was motivation for such a large overhaul of both ecosystems.\u003c/p\u003e","post_number":13,"post_type":1,"updated_at":"2024-02-22T12:33:13.905Z","reply_count":0,"reply_to_post_number":12,"quote_count":0,"incoming_link_count":4,"reads":221,"readers_count":220,"score":154.2,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Greg Roodt","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"flair_group_id":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"Kound","name":"Carli* Freudenberg","avatar_template":"/user_avatar/discuss.python.org/kound/{size}/8195_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":4,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":3160,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2021-01-03","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148053,"name":"Greg Roodt","username":"groodt","avatar_template":"/user_avatar/discuss.python.org/groodt/{size}/3248_2.png","created_at":"2024-02-22T12:34:17.998Z","cooked":"\u003cp\u003eWhat’s the PEP number going to be?\u003c/p\u003e","post_number":14,"post_type":1,"updated_at":"2024-02-22T12:34:17.998Z","reply_count":1,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":216,"readers_count":215,"score":48.2,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Greg Roodt","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"flair_group_id":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":3160,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2021-01-03","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148076,"name":"Hugo van Kemenade","username":"hugovk","avatar_template":"/user_avatar/discuss.python.org/hugovk/{size}/14505_2.png","created_at":"2024-02-22T13:35:03.575Z","cooked":"\u003cp\u003eIt’s a bit early for that. Let’s have a discussion first, and when Brett is ready to submit a PEP it’ll be the next number available.\u003c/p\u003e","post_number":15,"post_type":1,"updated_at":"2024-02-22T13:35:03.575Z","reply_count":0,"reply_to_post_number":14,"quote_count":0,"incoming_link_count":1,"reads":216,"readers_count":215,"score":138.2,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Hugo van Kemenade","primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_bg_color":"006b94","flair_color":"fac731","flair_group_id":41,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":"CPython core developer","title_is_group":true,"reply_to_user":{"username":"groodt","name":"Greg Roodt","avatar_template":"/user_avatar/discuss.python.org/groodt/{size}/3248_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":6,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":358,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2019-01-19","user_birthdate":"1904-01-01","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148091,"name":"Randy Döring","username":"radoering","avatar_template":"/user_avatar/discuss.python.org/radoering/{size}/8399_2.png","created_at":"2024-02-22T15:27:19.325Z","cooked":"\u003cp\u003eLet me try to assess this with my Poetry hat on (without saying that something is generally good or bad):\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e“lock entry”: a set of distribution files locked for a specific environment\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e[Goal] The ability to lock for multiple environments simultaneously for the same set of dependency specifiers\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eI think this goal is subtly but significantly different from Poetry’s goal. Poetry does not lock for a specific environment, it creates an environment-independent lock file. It’s more like one lock file for all possible environments than a lock file for multiple specific environments.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e[lock.marker] A table of environment markers used to produce the lock entry.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003ePoetry does not use a set of markers to produce an entry in the lock file. A lock file entry in Poetry’s format cannot be mapped to a set of markers like \u003ccode\u003e{python_version = \"3.10\", sys_platform = \"linux\"}\u003c/code\u003e but to a marker condition like \u003ccode\u003e\"python_version \u0026gt;= '3.9' and python_version \u0026lt; '3.12' or sys_platform == 'linux'\"\u003c/code\u003e (even though that’s not written to the lock file).\u003c/p\u003e\n\u003cp\u003eFurther, we just lock all available dists for a locked package version and decide at install time which dist to use. I assume \u003ca href=\"https://discuss.python.org/t/lock-files-again-but-this-time-w-sdists/46593/8\" class=\"inline-onebox\"\u003eLock files, again (but this time w/ sdists!) - #8 by cemici\u003c/a\u003e is right and it will result in an exponential explosion when we try to create a lock file in the proposed format.\u003c/p\u003e\n\u003cp\u003eMaybe, I’m missing something but so far, I don’t think that Poetry could adopt this format without giving up its key features. I’m not saying that Poetry’s lock file format is better (it definitively has flaws), it just has a slightly different goal.\u003c/p\u003e","post_number":16,"post_type":1,"updated_at":"2024-02-22T15:27:19.325Z","reply_count":3,"reply_to_post_number":null,"quote_count":0,"incoming_link_count":0,"reads":213,"readers_count":212,"score":87.6,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Randy Döring","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"flair_group_id":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":null,"bookmarked":false,"actions_summary":[{"id":2,"count":2,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":8178,"hidden":false,"trust_level":2,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2022-08-04","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148103,"name":"Seth Michael Larson","username":"sethmlarson","avatar_template":"/user_avatar/discuss.python.org/sethmlarson/{size}/1644_2.png","created_at":"2024-02-22T16:39:10.452Z","cooked":"\u003cp\u003eExciting! Love the approach so far.\u003c/p\u003e\n\u003caside class=\"quote group-committers\" data-username=\"brettcannon\" data-post=\"1\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/brettcannon/48/36_2.png\" class=\"avatar\"\u003e Brett Cannon:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAn inline table of hashes of this file’s contents w/o the line containing the table (i.e. including the newline); algorithm:value pairs. Since this file is meant to be human-readable but machine-writable this makes sure people don’t accidentally try to edit the file by hand and break associations between various parts of the file.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eI love the goal of this, but I’m concerned about this value being based on serialized TOML content instead of the values encoded in the TOML. I’m imagining interactions between TOML auto-formatters and lockfile tooling causing frustration for users. To avoid this we could base this hash value on the values themselves instead of the serialized TOML? A simple example to illustrate my suggestion being: \u003ccode\u003ehash(json.dumps(..., sort_keys=True))\u003c/code\u003e\u003c/p\u003e\n\u003caside class=\"quote group-committers\" data-username=\"brettcannon\" data-post=\"1\" data-topic=\"46593\"\u003e\n\u003cdiv class=\"title\"\u003e\n\u003cdiv class=\"quote-controls\"\u003e\u003c/div\u003e\n\u003cimg loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea2.discourse-cdn.com/business6/user_avatar/discuss.python.org/brettcannon/48/36_2.png\" class=\"avatar\"\u003e Brett Cannon:\u003c/div\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHaving the name as a distinct key also has the benefit that its easier to read than from a wheel file name.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003c/aside\u003e\n\u003cp\u003eShould we include the wheel/sdist files’ \u003ccode\u003eversion\u003c/code\u003e for similar reasons?\u003c/p\u003e\n\u003cp\u003eLove the definition for \u003ccode\u003elock.sdist.build-requires\u003c/code\u003e, do you have an example using this feature?\u003c/p\u003e\n\u003cp\u003eFor hashes it’s common to require at least one algorithm always be present for interoperability, I recommend \u003ccode\u003esha256\u003c/code\u003e?\u003c/p\u003e","post_number":17,"post_type":1,"updated_at":"2024-02-22T16:39:10.452Z","reply_count":2,"reply_to_post_number":null,"quote_count":1,"incoming_link_count":21,"reads":214,"readers_count":213,"score":217.8,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Seth Michael Larson","primary_group_name":"psf-staff","flair_name":"psf-staff","flair_url":"fa-users","flair_bg_color":"306998ff","flair_color":"ffd43bff","flair_group_id":42,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":"PSF Staff","title_is_group":true,"bookmarked":false,"actions_summary":[{"id":2,"count":4,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":1414,"hidden":false,"trust_level":4,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2019-12-16","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148104,"name":"Frazer McLean","username":"RazerM","avatar_template":"/user_avatar/discuss.python.org/razerm/{size}/219_2.png","created_at":"2024-02-22T16:41:19.070Z","cooked":"\u003cp\u003eI think what I’ve been hoping for, is as \u003ca class=\"mention\" href=\"/u/radoering\"\u003e@radoering\u003c/a\u003e put it, an “environment-independent lock file”.\u003c/p\u003e\n\u003cp\u003eI can’t tell if the idea here is that lock file generators are expected to lock multiple environments automatically based on the environment markers and wheels they come across, or if the idea is that a user needs to configure the environments they’re targeting. I assume the former, because things like manylinux versions can be confusing for beginners or developers that don’t follow packaging PEPs.\u003c/p\u003e","post_number":18,"post_type":1,"updated_at":"2024-02-22T16:42:05.019Z","reply_count":1,"reply_to_post_number":16,"quote_count":0,"incoming_link_count":1,"reads":206,"readers_count":205,"score":66.2,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Frazer McLean","primary_group_name":null,"flair_name":null,"flair_url":null,"flair_bg_color":null,"flair_color":null,"flair_group_id":null,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":null,"reply_to_user":{"username":"radoering","name":"Randy Döring","avatar_template":"/user_avatar/discuss.python.org/radoering/{size}/8399_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":1,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":171,"hidden":false,"trust_level":1,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"notice":{"type":"returning_user","last_posted_at":"2018-10-31T13:01:42Z"},"user_cakedate":"2018-10-31","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148106,"name":"Carol Willing","username":"willingc","avatar_template":"/user_avatar/discuss.python.org/willingc/{size}/20_2.png","created_at":"2024-02-22T17:01:07.415Z","cooked":"\u003cp\u003ecc’ing science folks for awareness:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca class=\"mention\" href=\"/u/lwasser\"\u003e@lwasser\u003c/a\u003e for pyOpenSci\u003c/li\u003e\n\u003cli\u003e\u003ca class=\"mention\" href=\"/u/rgommers\"\u003e@rgommers\u003c/a\u003e \u003ca class=\"mention\" href=\"/u/trallard\"\u003e@trallard\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","post_number":19,"post_type":1,"updated_at":"2024-02-22T17:01:07.415Z","reply_count":1,"reply_to_post_number":2,"quote_count":0,"incoming_link_count":2,"reads":206,"readers_count":205,"score":116.2,"yours":true,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Carol Willing","primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_bg_color":"006b94","flair_color":"fac731","flair_group_id":41,"version":1,"can_edit":true,"can_delete":true,"can_recover":false,"can_see_hidden_post":true,"can_wiki":true,"read":true,"user_title":"CPython core developer","title_is_group":true,"reply_to_user":{"username":"brettcannon","name":"Brett Cannon","avatar_template":"/user_avatar/discuss.python.org/brettcannon/{size}/36_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"count":4},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":14,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2018-09-28","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false},{"id":148110,"name":"Paul Moore","username":"pf_moore","avatar_template":"/user_avatar/discuss.python.org/pf_moore/{size}/35_2.png","created_at":"2024-02-22T17:19:01.922Z","cooked":"\u003cp\u003eIn pip’s case we could create either a lock file with a fully-specified environment matching the environment pip was run against, or a “generic” environment where we leave the environment markers empty and it’s the user’s responsibility to only install the lockfile against the correct environment. PIp isn’t a multi-environment installer and so couldn’t do multi-environment locks.\u003c/p\u003e\n\u003cp\u003eI’m not sure what installers are intended to do here. Brett’s mousebender implementation has two modes:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eStrict match, which checks if the markers and tags in the lock entry match the current environment exactly.\u003c/li\u003e\n\u003cli\u003e“Compatible” match, which checks if the lock entry tags is a subset of the environment tags, and ignores markers.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThese seem reasonable options, although I feel that strict matches could be fragile, especially given that we now have packaging utilities written in both Python and Rust, and we can’t assume that the exact values produced by the \u003ccode\u003epackaging\u003c/code\u003e library will be used by all tools (the precise list of tags supported by a given Python implementation isn’t standardised, for example, nor is it obtained by querying the interpreter).\u003c/p\u003e","post_number":20,"post_type":1,"updated_at":"2024-02-22T17:19:01.922Z","reply_count":1,"reply_to_post_number":18,"quote_count":0,"incoming_link_count":0,"reads":209,"readers_count":208,"score":46.8,"yours":false,"topic_id":46593,"topic_slug":"lock-files-again-but-this-time-w-sdists","display_username":"Paul Moore","primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_bg_color":"006b94","flair_color":"fac731","flair_group_id":41,"version":1,"can_edit":false,"can_delete":false,"can_recover":false,"can_see_hidden_post":true,"can_wiki":false,"read":true,"user_title":"CPython core developer","title_is_group":true,"reply_to_user":{"username":"RazerM","name":"Frazer McLean","avatar_template":"/user_avatar/discuss.python.org/razerm/{size}/219_2.png"},"bookmarked":false,"actions_summary":[{"id":2,"can_act":true},{"id":3,"can_act":true},{"id":4,"can_act":true},{"id":8,"can_act":true},{"id":6,"can_act":true},{"id":7,"can_act":true},{"id":10,"can_act":true}],"moderator":false,"admin":false,"staff":false,"user_id":35,"hidden":false,"trust_level":3,"deleted_at":null,"user_deleted":false,"edit_reason":null,"can_view_edit_history":true,"wiki":false,"user_cakedate":"2018-09-28","can_accept_answer":false,"can_unaccept_answer":false,"accepted_answer":false,"topic_accepted_answer":false}],"stream":[147940,147941,147977,147982,148009,148017,148034,148035,148037,148039,148044,148049,148052,148053,148076,148091,148103,148104,148106,148110,148126,148151,148157,148164,148189,148191,148193,148194,148195,148196,148197,148199,148201,148203,148205,148207,148209,148239,148241,148242,148267,148270,148272,148300,148327,148328,148341,148371,148372,148373,148374,148375,148378,148379,148381,148402,148414,148418,148424,148442,148446,148455,148462,148463,148466,148471,148474,148478,148481,148484,148494,148499,148502,148504,148505,148508,148512,148515,148516,148518,148519,148520,148522,148525,148526,148527,148537,148549,148558,148565,148574,148578,148580,148581,148582,148584,148588,148589,148590,148591,148594,148595,148597,148600,148602,148604,148605,148606,148607,148609,148611,148613,148623,148625,148627,148630,148635,148641,148648,148659,148665,148685,148725,148730,148736,148753,148760,148764,148766,148767,148770,148784,148828,148832,148854,148917,149007,149012,149016,149021,149024,149025,149061,149068,149093,149112,149122,149132,149146,149151,149164,149179,149182,149193,149209,149231,149242,149262,149266,149267,149269,149274,149276,149277,149282,149283,149289,149291,149294,149296,149298,149303,149323,149329,149330,149334,149340,149342,149345,149347,149349,149354,149408,149414,149428,149431,149449,149458,149469,149619,149620,149656,149678,149841,149849,149860,150141,150146,150180,150181,150275,150279,150286,150313,150320,150323,150324,150325,150330,150331,150343,150356,150417,150428,150430,150431,150434,150439,150444,150455,150461,150465,150467,150469,150470,150472,150475,150478,150504,150506,150575,150580,150590,150596,150728,150734,150736,150739,150742,150803,150811,150832,150993,150995,151027,151091,151160,151174,151217,151234,151261,151266,151271,151295,151345,151363,151425,151465,151512,151515,151526,151539,151540,151541,151548,151550,151551,151554,151587,151692,151703,151721,151735,151737,151740,151749,151755,151756,151759,151760,151762,151763,151764,151775,151787,151793,151794,151796,151800,151805,151843,151878,151984,151993,152058]},"timeline_lookup":[[1,18],[5,17],[41,16],[59,15],[119,14],[135,13],[149,12],[183,11],[194,10],[197,9],[199,8],[213,7],[235,6],[243,5],[247,4],[256,3],[270,2],[291,1],[295,0]],"tags":[],"tags_descriptions":{},"id":46593,"title":"Lock files, again (but this time w/ sdists!)","fancy_title":"Lock files, again (but this time w/ sdists!)","posts_count":295,"created_at":"2024-02-22T02:04:37.017Z","views":7387,"reply_count":231,"like_count":714,"last_posted_at":"2024-03-10T15:37:44.121Z","visible":true,"closed":false,"archived":false,"has_summary":true,"archetype":"regular","slug":"lock-files-again-but-this-time-w-sdists","category_id":35,"word_count":79793,"deleted_at":null,"user_id":36,"featured_link":null,"pinned_globally":false,"pinned_at":null,"pinned_until":null,"image_url":null,"slow_mode_seconds":0,"draft":null,"draft_key":"topic_46593","draft_sequence":13,"posted":true,"unpinned":null,"pinned":false,"current_post_number":1,"highest_post_number":297,"last_read_post_number":297,"last_read_post_id":152058,"deleted_by":null,"actions_summary":[{"id":4,"count":0,"hidden":false,"can_act":true},{"id":8,"count":0,"hidden":false,"can_act":true},{"id":7,"count":0,"hidden":false,"can_act":true},{"id":10,"count":0,"hidden":false,"can_act":true}],"chunk_size":20,"bookmarked":false,"bookmarks":[],"topic_timer":null,"message_bus_last_id":2656,"participant_count":43,"show_read_indicator":false,"thumbnails":null,"slow_mode_enabled_until":null,"summarizable":false,"tags_disable_ads":false,"related_topics":null,"can_vote":false,"vote_count":0,"user_voted":false,"discourse_zendesk_plugin_zendesk_id":null,"discourse_zendesk_plugin_zendesk_url":"https://your-url.zendesk.com/agent/tickets/","details":{"can_edit":true,"notification_level":2,"notifications_reason_id":4,"can_invite_to":true,"can_invite_via_email":true,"can_create_post":true,"can_reply_as_new_topic":true,"can_flag_topic":true,"participants":[{"id":35,"username":"pf_moore","name":"Paul Moore","avatar_template":"/user_avatar/discuss.python.org/pf_moore/{size}/35_2.png","post_count":51,"primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_color":"fac731","flair_bg_color":"006b94","flair_group_id":41,"trust_level":3},{"id":3160,"username":"groodt","name":"Greg Roodt","avatar_template":"/user_avatar/discuss.python.org/groodt/{size}/3248_2.png","post_count":35,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":36,"username":"brettcannon","name":"Brett Cannon","avatar_template":"/user_avatar/discuss.python.org/brettcannon/{size}/36_2.png","post_count":32,"primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_color":"fac731","flair_bg_color":"006b94","flair_group_id":41,"admin":true,"moderator":true,"trust_level":4},{"id":21554,"username":"cemici","name":"Cemici","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/c/91b2a8/{size}.png","post_count":24,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":9915,"username":"charliermarsh","name":"Charlie Marsh","avatar_template":"/user_avatar/discuss.python.org/charliermarsh/{size}/10246_2.png","post_count":20,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":9947,"username":"alicederyn","name":"Alice","avatar_template":"/user_avatar/discuss.python.org/alicederyn/{size}/10282_2.png","post_count":17,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":899,"username":"ofek","name":"Ofek Lev","avatar_template":"/user_avatar/discuss.python.org/ofek/{size}/1033_2.png","post_count":17,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":98,"username":"ncoghlan","name":"Alyssa Coghlan","avatar_template":"/user_avatar/discuss.python.org/ncoghlan/{size}/14266_2.png","post_count":15,"primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_color":"fac731","flair_bg_color":"006b94","flair_group_id":41,"trust_level":3},{"id":5011,"username":"BrenBarn","name":"Brendan Barnwell","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/b/74df32/{size}.png","post_count":8,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":15730,"username":"mikeshardmind","name":"Michael H","avatar_template":"/user_avatar/discuss.python.org/mikeshardmind/{size}/14381_2.png","post_count":7,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":3},{"id":8178,"username":"radoering","name":"Randy Döring","avatar_template":"/user_avatar/discuss.python.org/radoering/{size}/8399_2.png","post_count":6,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":1455,"username":"EpicWink","name":"Laurie O","avatar_template":"/user_avatar/discuss.python.org/epicwink/{size}/17968_2.png","post_count":5,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":6709,"username":"tmk","name":"Thomas Kehrenberg","avatar_template":"/user_avatar/discuss.python.org/tmk/{size}/10935_2.png","post_count":4,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":262,"username":"frostming","name":"Frost Ming","avatar_template":"/user_avatar/discuss.python.org/frostming/{size}/326_2.png","post_count":4,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":54,"username":"steve.dower","name":"Steve Dower","avatar_template":"/user_avatar/discuss.python.org/steve.dower/{size}/56_2.png","post_count":4,"primary_group_name":"committers","flair_name":"committers","flair_url":"https://global.discourse-cdn.com/business6/uploads/python1/original/1X/ca0883b21b8210c5a62c9ac02353de5f24a4d6fc.png","flair_color":"fac731","flair_bg_color":"006b94","flair_group_id":41,"trust_level":3},{"id":1498,"username":"aragilar","name":"James Tocknell","avatar_template":"https://avatars.discourse-cdn.com/v4/letter/a/c57346/{size}.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":7131,"username":"jsirois","name":"John Sirois","avatar_template":"/user_avatar/discuss.python.org/jsirois/{size}/7062_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":1},{"id":7333,"username":"jvolkman","name":"Jeremy Volkman","avatar_template":"/user_avatar/discuss.python.org/jvolkman/{size}/7328_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":25494,"username":"samypr100","name":"samypr100","avatar_template":"/user_avatar/discuss.python.org/samypr100/{size}/17966_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":1},{"id":2630,"username":"johnthagen","name":"John Hagen","avatar_template":"/user_avatar/discuss.python.org/johnthagen/{size}/3780_2.png","post_count":3,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":1414,"username":"sethmlarson","name":"Seth Michael Larson","avatar_template":"/user_avatar/discuss.python.org/sethmlarson/{size}/1644_2.png","post_count":3,"primary_group_name":"psf-staff","flair_name":"psf-staff","flair_url":"fa-users","flair_color":"ffd43bff","flair_bg_color":"306998ff","flair_group_id":42,"trust_level":4},{"id":5621,"username":"mdrissi","name":"Mehdi Drissi","avatar_template":"/user_avatar/discuss.python.org/mdrissi/{size}/5427_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":4128,"username":"fungi","name":"fungi","avatar_template":"/user_avatar/discuss.python.org/fungi/{size}/5963_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2},{"id":11681,"username":"mitsuhiko","name":"Armin Ronacher","avatar_template":"/user_avatar/discuss.python.org/mitsuhiko/{size}/12209_2.png","post_count":2,"primary_group_name":null,"flair_name":null,"flair_url":null,"flair_color":null,"flair_bg_color":null,"flair_group_id":null,"trust_level":2}],"created_by":{"id":36,"username":"brettcannon","name":"Brett Cannon","avatar_template":"/user_avatar/discuss.python.org/brettcannon/{size}/36_2.png"},"last_poster":{"id":8178,"username":"radoering","name":"Randy Döring","avatar_template":"/user_avatar/discuss.python.org/radoering/{size}/8399_2.png"},"links":[{"url":"https://github.com/brettcannon/mousebender/blob/resolve/pylock.compatibility-example.toml","title":"mousebender/pylock.compatibility-example.toml at resolve · brettcannon/mousebender · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":78,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://peps.python.org/pep-0665/","title":"PEP 665 – A file format to list Python dependencies for reproducibility of an application | peps.python.org","internal":false,"attachment":false,"reflection":false,"clicks":70,"user_id":36,"domain":"peps.python.org","root_domain":"python.org"},{"url":"https://github.com/brettcannon/mousebender/blob/resolve/pylock.spec.toml","title":"mousebender/pylock.spec.toml at resolve · brettcannon/mousebender · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":54,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://discuss.python.org/t/pep-665-take-2-a-file-format-to-list-python-dependencies-for-reproducibility-of-an-application/11736/140","title":"PEP 665, take 2 -- A file format to list Python dependencies for reproducibility of an application","internal":true,"attachment":false,"reflection":false,"clicks":29,"user_id":36,"domain":"discuss.python.org","root_domain":"python.org"},{"url":"https://github.com/brettcannon/mousebender/blob/resolve/pylock.graph-example.toml","title":"mousebender/pylock.graph-example.toml at resolve · brettcannon/mousebender · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":26,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/brettcannon/mousebender/blob/resolve/pylock.graph-example.md","title":"mousebender/pylock.graph-example.md at resolve · brettcannon/mousebender · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":23,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://gist.github.com/pfmoore/d595e2bfc97fabb7a62e8c29368277cd","title":"Create a lock file based on a \"pip install\" command · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":22,"user_id":35,"domain":"gist.github.com","root_domain":"github.com"},{"url":"https://news.ycombinator.com/item?id=39392509","title":"Yes, we absolutely want to support platform-agnostic lockfiles. Very important t... | Hacker News","internal":false,"attachment":false,"reflection":false,"clicks":19,"user_id":21554,"domain":"news.ycombinator.com","root_domain":"ycombinator.com"},{"url":"https://github.com/pypi/warehouse/issues/8254#issuecomment-1962137260","title":"Expose the METADATA file of wheels in the simple API · Issue #8254 · pypi/warehouse · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":15,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/brettcannon/mousebender/tree/resolve-markers-tags-requirements","title":"GitHub - brettcannon/mousebender at resolve-markers-tags-requirements","internal":false,"attachment":false,"reflection":false,"clicks":14,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/astral-sh/uv/issues/1870#issuecomment-1960335012","title":"Can we use uv for dependency management like poetry · Issue #1870 · astral-sh/uv · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":14,"user_id":25494,"domain":"github.com","root_domain":"github.com"},{"url":"https://peps.python.org/pep-0714/","title":"PEP 714 – Rename dist-info-metadata in the Simple API | peps.python.org","internal":false,"attachment":false,"reflection":false,"clicks":14,"user_id":36,"domain":"peps.python.org","root_domain":"python.org"},{"url":"https://github.com/brettcannon/mousebender/tree/resolve","title":"GitHub - brettcannon/mousebender at resolve","internal":false,"attachment":false,"reflection":false,"clicks":13,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://pip.pypa.io/en/stable/reference/installation-report/","title":"Installation Report - pip documentation v24.0","internal":false,"attachment":false,"reflection":false,"clicks":11,"user_id":35,"domain":"pip.pypa.io","root_domain":"pypa.io"},{"url":"https://opendev.org/openstack/requirements/src/commit/94fa443/upper-constraints.txt#L42-L43","title":"requirements/upper-constraints.txt at 94fa443 - requirements - OpenDev: Free Software Needs Free Tools","internal":false,"attachment":false,"reflection":false,"clicks":9,"user_id":4128,"domain":"opendev.org","root_domain":"opendev.org"},{"url":"https://discuss.python.org/t/insights-into-how-poetry-lock-works-cross-platform/17846/24","title":"Insights into how poetry.lock works cross platform","internal":true,"attachment":false,"reflection":false,"clicks":9,"user_id":3160,"domain":"discuss.python.org","root_domain":"python.org"},{"url":"https://packaging.python.org/en/latest/specifications/dependency-specifiers/","title":"Dependency specifiers - Python Packaging User Guide","internal":false,"attachment":false,"reflection":false,"clicks":9,"user_id":36,"domain":"packaging.python.org","root_domain":"python.org"},{"url":"https://github.com/python-poetry/poetry/issues/496","title":"Make the lock file more merge-friendly · Issue #496 · python-poetry/poetry · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":8,"user_id":899,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/brettcannon/mousebender/blob/resolve-markers-tags-requirements/pylock.marker-example.toml","title":"mousebender/pylock.marker-example.toml at resolve-markers-tags-requirements · brettcannon/mousebender · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":8,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/brettcannon/mousebender/blob/80267617a92ddbb91e0e34c2117f175ae8c63d38/update-examples.sh#L17-L20","title":"mousebender/update-examples.sh at 80267617a92ddbb91e0e34c2117f175ae8c63d38 · brettcannon/mousebender · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":7,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://pypi.org/project/charset-normalizer/#files","title":"charset-normalizer · PyPI","internal":false,"attachment":false,"reflection":false,"clicks":6,"user_id":21554,"domain":"pypi.org","root_domain":"pypi.org"},{"url":"https://packaging.python.org/en/latest/specifications/version-specifiers/#file-urls","title":"Version specifiers - Python Packaging User Guide","internal":false,"attachment":false,"reflection":false,"clicks":6,"user_id":1455,"domain":"packaging.python.org","root_domain":"python.org"},{"url":"https://packaging.python.org/en/latest/specifications/","title":"PyPA specifications - Python Packaging User Guide","internal":false,"attachment":false,"reflection":false,"clicks":6,"user_id":36,"domain":"packaging.python.org","root_domain":"python.org"},{"url":"https://peps.python.org/pep-0011/#support-tiers","title":"PEP 11 – CPython platform support | peps.python.org","internal":false,"attachment":false,"reflection":false,"clicks":6,"user_id":25494,"domain":"peps.python.org","root_domain":"python.org"},{"url":"https://packaging.python.org/en/latest/specifications/direct-url-data-structure/","title":"Direct URL Data Structure - Python Packaging User Guide","internal":false,"attachment":false,"reflection":false,"clicks":5,"user_id":35,"domain":"packaging.python.org","root_domain":"python.org"},{"url":"https://download.pytorch.org/whl/torch/","title":null,"internal":false,"attachment":false,"reflection":false,"clicks":5,"user_id":7131,"domain":"download.pytorch.org","root_domain":"pytorch.org"},{"url":"https://github.com/conda/conda-lock","title":"GitHub - conda/conda-lock: Lightweight lockfile for conda environments","internal":false,"attachment":false,"reflection":false,"clicks":5,"user_id":9921,"domain":"github.com","root_domain":"github.com"},{"url":"https://gist.github.com/jvolkman/6f7c0a01e3d9c6af081c2839b9bf65c9#file-lock-bzl-L221-L301","title":"generated pycross targets · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":4,"user_id":1017,"domain":"gist.github.com","root_domain":"github.com"},{"url":"https://github.com/brettcannon/mousebender/blob/resolve/update-examples.sh","title":"mousebender/update-examples.sh at resolve · brettcannon/mousebender · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":4,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/DataDog/integrations-core/blob/98ab5d3fd0d2bb976c772164a3050ebba9f5fa2e/.deps/resolved/linux-x86_64_py3.txt","title":"integrations-core/.deps/resolved/linux-x86_64_py3.txt at 98ab5d3fd0d2bb976c772164a3050ebba9f5fa2e · DataDog/integrations-core · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":4,"user_id":899,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/basnijholt/unidep","title":"GitHub - basnijholt/unidep: Single source of truth with requirements for pip and conda","internal":false,"attachment":false,"reflection":false,"clicks":3,"user_id":8010,"domain":"github.com","root_domain":"github.com"},{"url":"https://discuss.python.org/t/restricting-open-ended-releases-on-pypi/43566","title":"Restricting \"open ended\" releases on PyPI?","internal":true,"attachment":false,"reflection":false,"clicks":3,"user_id":3160,"domain":"discuss.python.org","root_domain":"python.org"},{"url":"https://gist.github.com/jvolkman/05658a8d6f67342ab49c55f707899038#file-query-sql-L21-L27","title":"how many pypi packages use different sets of requirements per wheel? · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":3,"user_id":7333,"domain":"gist.github.com","root_domain":"github.com"},{"url":"https://github.com/jazzband/pip-tools/issues/1330","title":"Provide a way to limit to a single hash per requirement when generating hashes · Issue #1330 · jazzband/pip-tools · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":3,"user_id":3160,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/jvolkman/rules_pycross/blob/main/examples/lock_repo/pdm.lock","title":"rules_pycross/examples/lock_repo/pdm.lock at main · jvolkman/rules_pycross · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":3,"user_id":7333,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/python-poetry/poetry/blob/main/poetry.lock","title":"poetry/poetry.lock at main · python-poetry/poetry · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":3,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://github.com/Textualize/rich/blob/0d7e598fe7ead1cca6b590c1de7f54ba19255d11/pyproject.toml#L31","title":"rich/pyproject.toml at 0d7e598fe7ead1cca6b590c1de7f54ba19255d11 · Textualize/rich · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":3,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://pdm-project.org/latest/usage/dependency/#lock-strategies","title":"Manage Dependencies - PDM","internal":false,"attachment":false,"reflection":false,"clicks":3,"user_id":262,"domain":"pdm-project.org","root_domain":"pdm-project.org"},{"url":"https://peps.python.org/pep-0658/","title":"PEP 658 – Serve Distribution Metadata in the Simple Repository API | peps.python.org","internal":false,"attachment":false,"reflection":false,"clicks":3,"user_id":36,"domain":"peps.python.org","root_domain":"python.org"},{"url":"https://github.com/python-poetry/poetry/blob/410421861825ddb26383ba212320df78e7e98886/poetry.lock#L14-L19","title":"poetry/poetry.lock at 410421861825ddb26383ba212320df78e7e98886 · python-poetry/poetry · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":2,"user_id":21554,"domain":"github.com","root_domain":"github.com"},{"url":"https://packaging.python.org/en/latest/specifications/direct-url/","title":"Recording the Direct URL Origin of installed distributions - Python Packaging User Guide","internal":false,"attachment":false,"reflection":false,"clicks":2,"user_id":36,"domain":"packaging.python.org","root_domain":"python.org"},{"url":"https://discuss.python.org/t/pep-665-take-2-a-file-format-to-list-python-dependencies-for-reproducibility-of-an-application/11736","title":"PEP 665, take 2 -- A file format to list Python dependencies for reproducibility of an application","internal":true,"attachment":false,"reflection":false,"clicks":2,"user_id":1455,"domain":"discuss.python.org","root_domain":"python.org"},{"url":"https://github.com/macro128/pdm-conda","title":"GitHub - macro128/pdm-conda: A PDM plugin to install project dependencies with Conda","internal":false,"attachment":false,"reflection":false,"clicks":2,"user_id":8010,"domain":"github.com","root_domain":"github.com"},{"url":"https://packaging.python.org/en/latest/specifications/dependency-specifiers/#environment-markers","title":"Dependency specifiers - Python Packaging User Guide","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":36,"domain":"packaging.python.org","root_domain":"python.org"},{"url":"https://github.com/brettcannon/mousebender/blob/69c800f275a2303d0b10d4e07338d52fa0ce98f7/mousebender/install.py#L16","title":"mousebender/mousebender/install.py at 69c800f275a2303d0b10d4e07338d52fa0ce98f7 · brettcannon/mousebender · GitHub","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":36,"domain":"github.com","root_domain":"github.com"},{"url":"https://packaging.python.org/en/latest/specifications/pyproject-toml/#declaring-build-system-dependencies-the-build-system-table","title":"pyproject.toml specification - Python Packaging User Guide","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":36,"domain":"packaging.python.org","root_domain":"python.org"},{"url":"https://github.com/astral-sh/uv?tab=readme-ov-file#resolution-strategy","title":"GitHub - astral-sh/uv: An extremely fast Python package installer and resolver, written in Rust.","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":3160,"domain":"github.com","root_domain":"github.com"},{"url":"https://pypi.org/project/installer/","title":"installer · PyPI","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":1455,"domain":"pypi.org","root_domain":"pypi.org"},{"url":"https://github.com/astral-sh/uv?tab=readme-ov-file#reproducible-resolution","title":"GitHub - astral-sh/uv: An extremely fast Python package installer and resolver, written in Rust.","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":3160,"domain":"github.com","root_domain":"github.com"},{"url":"https://warehouse.pypa.io/api-reference/bigquery-datasets.html","title":"BigQuery Datasets - Warehouse documentation","internal":false,"attachment":false,"reflection":false,"clicks":1,"user_id":35,"domain":"warehouse.pypa.io","root_domain":"pypa.io"}]},"pending_posts":[]}
